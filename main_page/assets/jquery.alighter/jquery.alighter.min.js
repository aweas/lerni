(function(a){a.fn.alighter=function(b){b=a.extend({},a.fn.alighter.defaultOptions,b);a(this).each(function(){var c=a(this).find(b.selector);if(a(this).outerWidth()>a(this).outerHeight()){var d=a(this).outerWidth()}else{var d=a(this).outerHeight()}var e={reference:a(this),referenceDim:d,options:b,elements:[],countToALight:c.length,currentToALight:0,alight:function(b){if(typeof b!="undefined"&&b<this.countToALight){this.currentToALight=b}var c=this.reference.children(".alighter_cnt");if(c.length<=0){var d=true;c=a('<div class="alighter_cnt"><div class="alighter"></div></div>');c.css({position:"absolute","z-index":99,width:"1px",height:"1px",opacity:this.options.opacity});var e=this.options.shadowBlurSize+"px 0 "+this.options.shadowBlurSize+"px "+this.options.color+" inset, 0 "+this.options.shadowBlurSize+"px "+this.options.shadowBlurSize+"px "+this.options.color+" inset, -"+this.options.shadowBlurSize+"px 0 "+this.options.shadowBlurSize+"px "+this.options.color+" inset, 0 -"+this.options.shadowBlurSize+"px "+this.options.shadowBlurSize+"px "+this.options.color+" inset";c.children(".alighter").css({"background-color":"transparent",border:this.referenceDim*2+"px solid "+this.options.color,"box-shadow":e,"-moz-box-shadow":e,"-webkit-box-shadow":e});this.reference.append(c)}else{var d=false}var f=this.elements[this.currentToALight];var g={top:f.offset.top+f.height/2+"px",left:f.offset.left+f.width/2+"px"};var h=this.options.shadowBlurSize*2+this.options.circlePadding;if(f.width>f.height){h+=f.width}else{h+=f.height}var i=this.referenceDim*2+h/2;var j={width:h+"px",height:h+"px","border-bottom-left-radius":i+"px","border-bottom-right-radius":i+"px","border-top-left-radius":i+"px","border-top-right-radius":i+"px","margin-top":"-"+i+"px","margin-left":"-"+i+"px"};if(d){var k=0}else{var k=this.options.animationDuration}this.reference.trigger("animationStart.alighter");c.stop().animate(g,k,this.options.animationEasing);c.children(".alighter").stop().animate(j,k,this.options.animationEasing,a.proxy(function(){this.reference.trigger("animationStop.alighter");if(this.currentToALight<this.countToALight-1){this.currentToALight++}else{this.currentToALight=0}if(this.options.timer>0){setTimeout(a.proxy(function(){this.reference.data("alightData").alight()},this),this.options.timer)}},this))}};a(this).css({position:"relative",overflow:"hidden"});c.each(function(){e.elements.push({offset:a(this).position(),width:a(this).outerWidth(),height:a(this).outerHeight()})});a(this).data("alightData",e);e.alight()});return a(this)};a.fn.alighter.defaultOptions={selector:".toALight",color:"#000",opacity:.1,shadowBlurSize:15,circlePadding:15,animationDuration:1e3,animationEasing:"swing",timer:2e3}})(jQuery)